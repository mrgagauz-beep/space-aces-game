# Режим тестирования (Test Mode)

## Запуск

```bash
python run.py --mode test
```

## Что делает тестовый режим

- Захватывает экран игры (MAIN) и миникарту (MINIMAP)
- Детектирует и визуализирует:
  - **Бонус-коробки** (жёлтые прямоугольники)
  - **Мобов** (красные прямоугольники)
  - **Надписи над мобами** (розовые прямоугольники + голубые точки кликов)
  - **Врагов на миникарте** (красные точки)
  - **Позицию игрока на миникарте** (голубая точка)
- Показывает счётчики детекций в реальном времени
- Отображает результаты в двух окнах OpenCV

## Управление

- **ESC** или **Q** - выход из тестового режима

## Настройка позиции окон

Окна OpenCV автоматически перемещаются в позицию `x=2000`, чтобы не попадать в область захвата экрана.

### Если окна всё ещё попадают в ROI (рекурсивный захват):

1. Откройте `run.py`
2. Найдите строки:
   ```python
   cv2.moveWindow(window_main, 2000, 100)
   cv2.moveWindow(window_minimap, 2000, 700)
   ```
3. Измените координаты:
   - **Увеличьте X** (например, 3000 для ультра-широких мониторов)
   - **Или используйте отрицательные значения** для второго монитора (-1920, 100)
   - **Или переместите влево** за пределы игры (100, 100)

### Рекомендации:

- Если у вас **один монитор**: переместите окна ниже игры или используйте малое разрешение окон
- Если у вас **два монитора**: используйте второй монитор (отрицательные X координаты)
- Если у вас **ультра-широкий монитор**: увеличьте X до 3000+

## Калибровка ROI

Если детекция работает неправильно, используйте утилиту калибровки:

```bash
python tools/calibrate_roi.py
```

Это поможет настроить области захвата MAIN и MINIMAP в `profiles/default.json`.

## Примеры настроек для разных разрешений

### Full HD (1920x1080) - игра на весь экран
```python
cv2.moveWindow(window_main, -800, 100)   # Второй монитор слева
cv2.moveWindow(window_minimap, -800, 700)
```

### Dual Monitor (2 x 1920x1080)
```python
cv2.moveWindow(window_main, 1920, 100)   # Второй монитор справа
cv2.moveWindow(window_minimap, 1920, 700)
```

### Ultrawide (3440x1440) - игра слева
```python
cv2.moveWindow(window_main, 2500, 100)   # Справа от игры
cv2.moveWindow(window_minimap, 2500, 700)
```

## Отладка

Если окна не появляются:
- Проверьте, что у вас установлен OpenCV: `pip list | grep opencv`
- Проверьте логи: `cat logs/space_aces.log`

Если детекция не находит объекты:
- Откройте `profiles/default.json`
- Настройте HSV пороги для вашей цветовой схемы игры
- Используйте `tools/calibrate_roi.py` для помощи
